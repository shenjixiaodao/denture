<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yuzi.denture.clinic.mapper.DentureOrderMapper" >

    <insert id="save" parameterType="com.yuzi.denture.clinic.domain.DentureOrder">
        INSERT INTO `liyou`.`denture_order`
        (
        `id`,
        `clinic_id`,
        `denture_id`,
        `factory_id`,
        `created_date`,
        `status`,
        `dentist_id`,
        `comment`
        )
        VALUES
        (
        #{id},
        #{clinic.id},
        #{dentureId},
        #{factory.id},
        #{createdDate},
        #{status},
        #{dentist.id},
        #{comment}
        );
    </insert>

    <resultMap id="baseRM" type="com.yuzi.denture.clinic.domain.DentureOrder">
        <result column="id" property="id" />
        <result column="denture_id" property="dentureId" />
        <result column="factory_id" property="factory.id" />
        <result column="created_date" property="createdDate" />
        <result column="pay_amount" property="payAmount" />
        <result column="status" property="status" />
        <result column="model_delivery_id" property="modelDeliveryInfo.id" />
        <result column="denture_delivery_id" property="dentureDeliveryInfo.id" />
        <result column="received_date" property="receivedDate" />
        <result column="installed_date" property="installedDate" />
        <result column="dentist_id" property="dentist.id" />
        <result column="patient_id" property="patient.id" />
        <result column="recorder_id" property="recorder.id" />
        <result column="comment" property="comment" />
        <association property="clinic" javaType="com.yuzi.denture.clinic.domain.Clinic">
            <result column="clinic_id" property="id" />
            <result column="clinic_name" property="name" />
            <result column="clinic_address" property="address" />
            <result column="clinic_contact" property="contact" />
        </association>
    </resultMap>

    <select id="findOrdersByClinicId" parameterType="Long" resultMap="baseRM">
        SELECT * FROM denture_order do
        WHERE do.clinic_id=#{clinicId}
    </select>

</mapper>